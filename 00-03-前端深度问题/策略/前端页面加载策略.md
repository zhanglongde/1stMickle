常见的前端页面加载策略一般为：后端从数据库读取出数据，拼装好必要的页面元素，图片做lazyload(懒加载)，用户通过浏览器加载页面上的所有HTML元素。

基于首屏加载时间最短的原则，我们的页面加载采用：楼层异步加载和本地缓存方式，具体如下：

1.把页面按楼层进行拆分，把首屏做为页面框架主体，每个楼层的数据，单独做成数据接口，异步加载，页面仅保留一个楼层一个DIV标签,比如如下服饰楼层:


其中floor1-floor_index.js是楼层数据文件 ,包含楼层数据和信赖的脚本文件，其样式已放在header里预加载。

2.给每个楼层设置默认高度，到达这个区域时请求当前楼层数据文件，同时对楼层数据文件进行md5(即data-time)，并把楼层请求后的数据文件和其data-time localStorage至本地，如果页面上的楼层data-time和本地localStorage中的data-time值一样，数据直接取localStorage，如果不一致，重新ajax请求数据，请求后同时会localStorage数据至本地；

3.第一次ajax请求数据时，会延时5秒，查看请求是否成功，如果成功则退出，如果失败：首先会取上次localStorage数据做垫底数据，但浏览器如果不支持localStorage, 基于高可用性原则考虑会进行第二次ajax请求数据，如果第二请求成功则正常渲染和localStorage楼层，如果第二次请求失败，此时极大可能说明网络存在异常，这时为了保持良好的用户体验，不能留有空白，直接隐藏当前楼层。

4.其中用户到达当前楼层时，请求楼层数据(包括楼层的html结构和当前楼层的脚本)，渲染数据到楼层元素中，同时初始化楼层脚本。另外楼层有提前预加载逻辑，即用户在第一二楼层时，提前加载好第三四五楼层的数据，到达楼层即显示当前楼层数据。

5.楼层异步加载和本地缓存方式的好处：页面大约共有3288个元素，首屏大约仅900左右，楼层数据lazyload，只渲染首屏元素，大大降低首屏页面内容大小，极大的缩短页面首屏加载完成时间，当时测算首屏约1.6s即加载完，时间比旧版和竞品缩短很多。

6.数据接口优先请求走本地localStorage，减少后台服务器压力，节约成本。请求数据时延时查看成功与否，同时二次请求保证高可用性。楼层之间数据和脚本完全解耦，有利于后期维护，可随意定时上线和下线运营楼层。

